variables:
  dmd_version: 2.087.1

stages:
- stage: CLI_Unittests
  dependsOn: []
  jobs:
  - template: job_linux_cli_unittest.yml
  - template: job_windows_cli_unittest.yml
  - template: job_osx_cli_unittest.yml
  
- stage: GTK_Unittests
  dependsOn: []
  jobs:
  - template: job_linux_gtk_unittest.yml
  - template: job_windows_gtk_unittest.yml
  - template: job_osx_gtk_unittest.yml

- stage: CLI_Releases
  dependsOn: [CLI_Unittests]
  jobs:
  - template: job_linux_cli_release.yml
  - template: job_windows_cli_release.yml
  - template: job_osx_cli_unittest.yml

- stage: GTK_Releases
  dependsOn: [GTK_Unittests]
  jobs:
  - template: job_linux_gtk_release.yml
  - template: job_windows_gtk_release.yml
  - template: job_osx_gtk_release.yml

- stage: GTK_Packages
  dependsOn: [GTK_Releases]
  jobs: GTK_Releases
  - template: job_linux_appimage_create.yml

# - stage: CLI_Search_Tests
#   dependsOn: [CLI_Releases]
#   jobs:
#   - template: job_linux_cli_name_test.yml
#   - template: job_windows_cli_name_test.yml
#   - template: job_osx_cli_name_test.yml
#   - template: job_linux_cli_content_test.yml
#   - template: job_windows_cli_content_test.yml
#   - template: job_osx_cli_content_test.yml

# - stage: AppImage_Tests
#   dependsOn: [CLI_Releases]
#   jobs:
#   - template: job_linux_cli_name_test.yml
#   - template: job_windows_cli_name_test.yml
#   - template: job_osx_cli_name_test.yml


# - stage: Publish
#   jobs:
#   - job: Publish_Beta
#     condition: and(succeeded(), eq(variables['Build.SourceBranch'], 'refs/heads/master'))
